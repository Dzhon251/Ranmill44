<p-toast></p-toast>
<p-confirmDialog></p-confirmDialog>

<div class="card shadow-6">
    <h2 class="card-title flex justify-content-center">
        <strong>ASIGNACIÓN DE CONSUMO</strong>
    </h2>

    <div class="card shadow-2 p-3 m-3">
        <div class="field grid align-items-center">
            <label for="calendario" class="col-fixed" style="width:250px">
                <strong>Seleccione la fecha para el registro:</strong>
            </label>
            <div class="col">
                <p-calendar 
                    [(ngModel)]="fechaSeleccionada"
                    [showIcon]="true" 
                    inputId="calendario"
                    dateFormat="dd/mm/yy"
                    (onSelect)="onFechaSeleccionada()">
                </p-calendar>
            </div>
            <p-button class="col" severity="success" (click)="guardarAsignacion()">GUARDAR</p-button>
        </div>
    </div>

    <div class="card shadow-6">
        <p-table class="p-datatable-sm" [value]="asignacionConsumoModel" [paginator]="true" [rows]="10" [showCurrentPageReport]="true"
            currentPageReportTemplate="Mostrando {first} a {last} de {totalRecords} entradas"
            [rowsPerPageOptions]="[10, 25, 50]" [tableStyle]="{ 'min-width': '50rem' }" [loading]="cargando">
            <ng-template pTemplate="header">
                <tr>
                    <th style="width: 3rem">#</th>
                    <th>CÉDULA</th>
                    <th>NOMBRES</th>
                    <th>OBSERVACIÓN</th>
                    <th>DESAYUNO</th>
                    <th>ALMUERZO</th>
                    <th>MERIENDA</th>
                </tr>
            </ng-template>
            <ng-template pTemplate="body" let-personal let-rowIndex="rowIndex">
                <tr>
                    <td>{{ rowIndex + 1 }}</td>
                    <td>{{ personal.perCedula }}</td>
                    <td>{{ personal.perGrado }} {{ personal.perArma }} {{ personal.perNombres }}</td>
                    <td>
                        <div>
                            <p-dropdown [options]="listaNovedades" [(ngModel)]="personal.novedadSeleccionada"
                                (ngModelChange)="onNovedadChange(personal)" optionLabel="novDetalle"
                                placeholder="Seleccione una Opción" />
                        </div>
                    </td>
                    <td class="text-center">
                        <i class="pi"
                            [ngClass]="{'pi-check-circle text-green-500': personal.valorDesayuno, 'pi-times-circle text-red-500': !personal.valorDesayuno}"></i>
                    </td>
                    <td class="text-center">
                        <i class="pi"
                            [ngClass]="{'pi-check-circle text-green-500': personal.valorAlmuerzo, 'pi-times-circle text-red-500': !personal.valorAlmuerzo}"></i>
                    </td>
                    <td class="text-center">
                        <i class="pi"
                            [ngClass]="{'pi-check-circle text-green-500': personal.valorMerienda, 'pi-times-circle text-red-500': !personal.valorMerienda}"></i>
                    </td>
                </tr>
            </ng-template>

            <ng-template pTemplate="empty">
                <tr>
                    <td colspan="8" class="text-center">No hay valores registrados.</td>
                </tr>
            </ng-template>
        </p-table>
    </div>
</div>